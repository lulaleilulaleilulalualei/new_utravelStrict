(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/lineDetail/lineDetail","components/loadErr"],{"0281":function(t,i,e){"use strict";e.r(i);var n=e("9f53"),o=e("8bdc");for(var a in o)"default"!==a&&function(t){e.d(i,t,function(){return o[t]})}(a);e("5f05");var c=e("2877"),s=Object(c["a"])(o["default"],n["a"],n["b"],!1,null,"dce3b504",null);i["default"]=s.exports},2598:function(t,i,e){"use strict";var n=e("aa0e"),o=e.n(n);o.a},"560c":function(t,i,e){"use strict";(function(t){e("610e"),e("921b");n(e("66fd"));var i=n(e("e2b8"));function n(t){return t&&t.__esModule?t:{default:t}}t(i.default)}).call(this,e("543d")["createPage"])},"5f05":function(t,i,e){"use strict";var n=e("6555"),o=e.n(n);o.a},6555:function(t,i,e){},"69be":function(t,i,e){"use strict";(function(t){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;n(e("0281")),e("2f62");function n(t){return t&&t.__esModule?t:{default:t}}var o={data:function(){return{isShowSkeleton:!1,navColor:"white",textOpacity:0,isLoadErr:!1,currentSwiper:0,swiperList:[],titleArr:[{name:"图片介绍",boxId:"lineIntro",boxTop:0,isActive:!0},{name:"行程线路",boxId:"journeyLine",boxTop:0,isActive:!1},{name:"费用说明",boxId:"useExplain",boxTop:0,isActive:!1},{name:"购买须知",boxId:"buyNotice",boxTop:0,isActive:!1}],lineArr:[],toViewScroll:0,navCutTop:null,navPostion:"absolute",isFloat:!1,scrollNum:null,isActive:!1,id:null,lineObj:{},lineLight:"",carRich:t.canIUse("rich-text"),isPlayVideo:!1,isAuth:!1}},onLoad:function(t){var i=this;this.id=t.id,this.$userInfo?(this.isAuth=!0,this.getDetailData()):this.$api.userLogin(function(t){1==t&&(i.isAuth=!0),i.getDetailData()})},computed:{customBar:function(){return this.CustomBar+"px"}},onShow:function(){var t=this;this.navCutTop||this.queryMultipleNodes("#contentNavBox",function(i){t.navCutTop=i-t.CustomBar})},methods:{getUserInfo:function(i){if("getUserInfo:ok"==i.detail.errMsg){t.showLoading({title:"授权登陆中...",mask:!0});var e=this;this.$api.userLogin(function(i){"1"==i&&(t.hideLoading(),t.showToast({title:"授权登录成功",icon:"success",mask:!0,success:function(){e.isAuth=!0,e.getDetailData()}}))})}else this.$api.warnNotice("您已拒绝授权！"),this.isAuth=!1},toPreviewImg:function(i){var e=this;t.previewImage({current:e.lineObj.top_comment.imgs[i],urls:e.lineObj.top_comment.imgs})},toJumpMemberCard:function(){t.navigateTo({url:"/pageMember/utravelMember/utravelMember"})},toJumpCommentList:function(){var i=this;t.navigateTo({url:"/pages/commentList/commentList?id=".concat(i.id,"&type=line")})},toScroll:function(t){var i=t.detail.scrollTop;this.textOpacity=i/400>1?1:i/400,this.navFloatScroll(i)},toPriviewBanner:function(i){var e=this,n=[];this.swiperList.map(function(t){"img"==t.type&&n.push(t.url)}),t.previewImage({current:e.swiperList[i].url,urls:n})},toSelectBatch:function(i){var e=this;0!=this.lineObj.batch_list.length?"number"==typeof i||"string"==typeof i?t.navigateTo({url:"/pages/selectBatch/selectBatch?id=".concat(e.id,"&date=").concat(e.lineObj.batch_list[i].date)}):t.navigateTo({url:"/pages/selectBatch/selectBatch?id=".concat(e.id)}):this.$api.warnNotice("当前线路没有班期")},bindChangeSwiper:function(t){this.currentSwiper=t.detail.current},scrollListen:function(t,i){null===this.scrollNum&&(this.scrollNum=t),this.scrollNum==t?this.isActive||(this.isActive=!0,"function"==typeof i&&i(t)):(this.scrollNum=t,"function"==typeof i&&i(t))},queryMultipleNodes:function(i,e){var n=t.createSelectorQuery().in(this);n.select(i).boundingClientRect(function(t){"function"==typeof e&&e(t.top)}).exec()},toCutTitle:function(t){var i=this;this.titleArr.map(function(e,n){t==n?(e.isActive=!0,i.toViewScroll=e.boxTop):e.isActive=!1})},navFloatScroll:function(t){var i=this;t>this.navCutTop?this.isFloat||(this.navPostion="fixed",this.isFloat=!0):this.isFloat&&(this.navPostion="absolute",this.isFloat=!1);for(var e=this.titleArr,n=0;n<e.length;n++)t>e[0].boxTop?e[n+1]?e[n].boxTop<=t&&t<e[n+1].boxTop&&this.scrollListen(n,function(t){i.titleArr.map(function(e,n){i.titleArr[n].isActive=n==t})}):t>e[n].boxTop&&this.scrollListen(n,function(t){i.titleArr.map(function(e,n){i.titleArr[n].isActive=n==t})}):this.titleArr[0].isActive=!0},toCollectLine:function(){0==this.lineObj.is_collected?this.addColoctLine():this.cancelColoctLine()},addColoctLine:function(){var i=this;this.$api.ajax({url:this.$config.addCollect,method:"POST",data:{type:1,third_id:this.id}}).then(function(e){200==e.statusCode&&0==e.data.code?t.showToast({title:"操作成功",icon:"success",success:function(){i.lineObj.is_collected=1,i.lineObj.collect_id=e.data.data}}):i.$api.warnNotice(e.data.message)}).catch(function(t){i.$api.warnNotice("收藏失败")})},cancelColoctLine:function(){var i=this;this.$api.ajax({url:this.$config.cancelCollect,method:"DELETE",data:{collect_id:this.lineObj.collect_id}}).then(function(e){200==e.statusCode&&0==e.data.code?t.showToast({title:"操作成功",icon:"success",success:function(){i.lineObj.is_collected=0}}):i.$api.warnNotice(e.data.message)}).catch(function(t){i.$api.warnNotice("取消收藏失败")})},toJumpSelectBatch:function(){var i=this;t.navigateTo({url:"/pages/selectBatch/selectBatch?id=".concat(i.id)})},toRelaodData:function(){this.isLoadErr=!1,this.getDetailData()},getDetailData:function(){var i=this;t.showLoading({title:"数据加载中",mask:!0});var e={rt_id:this.id};this.$userInfo&&(e.uid=this.$userInfo.uid),this.$api.ajax({url:this.$config.lineDetail,data:e}).then(function(e){if(200==e.statusCode&&0==e.data.code){var n=e.data.data;n.top_comment.picture_arr&&(n.top_comment.imgs=n.top_comment.picture_arr.split(",")),i.lineObj=n,i.lineArr=JSON.parse(n.route_content_json);var o=""!=n.picture_arr?n.picture_arr.split(","):n.thumb?[n.thumb]:[],a=[];if(o.map(function(t){a.push({url:t,type:"img"})}),i.swiperList=a,e.data.data.feature_text){var c=e.data.data.feature_text.replace(/section/g,"div");c=c.replace(/\<img/gi,'<img style="max-width:100%;height:auto"'),i.lineLight=c}else i.lineLight=e.data.data.feature_text;setTimeout(function(){i.titleArr.map(function(t,e){t.boxTop||i.queryMultipleNodes("#".concat(t.boxId),function(e){t.boxTop=e-(wx.getSystemInfoSync().windowWidth/750*82+i.CustomBar)})}),t.hideLoading()},1e3)}else t.hideLoading(),i.$api.warnNotice(e.data.message),i.isLoadErr=!0}).catch(function(e){t.hideLoading(),i.isLoadErr=!0})},toPlayVideo:function(){this.isPlayVideo=!0,t.createVideoContext("videoBox").requestFullScreen()},toQuitFullscreen:function(t){t.detail.fullScreen||(this.isPlayVideo=!1)}}};i.default=o}).call(this,e("543d")["default"])},8082:function(t,i,e){"use strict";var n=function(){var t=this,i=t.$createElement;t._self._c},o=[];e.d(i,"a",function(){return n}),e.d(i,"b",function(){return o})},"8bdc":function(t,i,e){"use strict";e.r(i);var n=e("94e9"),o=e.n(n);for(var a in n)"default"!==a&&function(t){e.d(i,t,function(){return n[t]})}(a);i["default"]=o.a},"94e9":function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n={data:function(){return{}},methods:{toRelaod:function(){this.$emit("toRelaodData",!0)}}};i.default=n},"9f53":function(t,i,e){"use strict";var n=function(){var t=this,i=t.$createElement;t._self._c},o=[];e.d(i,"a",function(){return n}),e.d(i,"b",function(){return o})},a70f:function(t,i,e){"use strict";e.r(i);var n=e("69be"),o=e.n(n);for(var a in n)"default"!==a&&function(t){e.d(i,t,function(){return n[t]})}(a);i["default"]=o.a},aa0e:function(t,i,e){},e2b8:function(t,i,e){"use strict";e.r(i);var n=e("8082"),o=e("a70f");for(var a in o)"default"!==a&&function(t){e.d(i,t,function(){return o[t]})}(a);e("2598");var c=e("2877"),s=Object(c["a"])(o["default"],n["a"],n["b"],!1,null,"7097616e",null);i["default"]=s.exports}},[["560c","common/runtime","common/vendor"]]]);